<% att = @attendances.select {|a| a.attendance_on == date && a.time_slot == time_slot}.first %>
<% if render_time_slot?(time_slot,date,att) -%>
<li class="list-group-item <%= 'today' if date.today? %> <%= 'other-users-ts' if time_slot.padma_uid != current_user.username %>">
  <h4><%= time_slot.name %></h4>
  <h5><%= timeslot_description(time_slot) %></h5>
  <% if att %>
    <div class="students-list">
      <%= att.contacts.map{|c| link_to_contact_profile(c)}.join(', ').html_safe %>
    </div>
    <%= link_to t('attendances.index.edit'), edit_attendance_path(att), :class => 'btn btn-xs' %>
    <%= link_to t('attendances.index.destroy'), att, :method => :delete, data: { confirm: t('confirm') }, :class => 'btn btn-xs btn-danger' %>
  <% else %>
    <div class="btn-group">
      <%= link_to t('attendances.index.new'), new_attendance_path(attendance: {attendance_on: date, time_slot_id: time_slot.id}), class: 'btn btn-default initialized_attendance' %>
      <%= link_to t('attendances.index.new_empty'), attendances_path(:attendance => {:attendance_on => date, :time_slot_id => time_slot.id}), :method => :post, :class => 'btn btn-default empty_attendance' %>
    </div>
  <% end %>
</li>
<% end %>
